/**
 * GroupInputs v. 0.8.1
 * @author Pavel Kornilov <pk@ostrovok.ru> <lusever@lusever.com>
 * https://github.com/lusever/groupinputs
 * MIT Licensed
 */
(function(e){function t(e,t,n){var r;if(t===undefined){t=0,n=0;if("selectionStart"in e)t=e.selectionStart,n=e.selectionEnd;else if(e.createTextRange){r=document.selection.createRange();var i=r.duplicate();r.parentElement()===e&&(t=-i.moveStart("character",-1e5),n=t+r.text.length)}return{start:t,end:n}}e.setSelectionRange?e.setSelectionRange(t,n):document.selection&&document.selection.createRange&&(r=e.createTextRange(),r.collapse(!0),r.moveEnd("character",n),r.moveStart("character",t),r.select())}e.fn.groupinputs=function(){function s(e,i){var s=e[0].value,o=t(e[0]).end,u=s.slice(0,o),a=s.slice(o),f=i.maxlength-a.length,l=!1,c,h,p;for(p=n.length-1;p>i.index;p--)f+=r[p]-n[p].value.length;u.length>f?(u=u.slice(0,f),h=f):h=o;if(s.length>i.maxlength){e[0].value=(u+a).slice(0,i.maxlength),h<=i.maxlength&&(t(e[0],h,h),l=!0),c=(u+a).slice(i.maxlength);if(c.length){h-=Math.min(i.maxlength,u.length);var d,v;while(n[++p]){d=r[p],c+=n[p].value,n.eq(p).val(c.slice(0,d)).change();if(c.length<=d)break;v=n[p].value.length,l||(h<d&&(l=!0,n.eq(p).focus(),t(n[p],h,h)),h-=v),c=c.slice(d)}}l||(n.eq(p).focus(),t(n[p],h,h))}}function o(r){var o=r.type,u=r.data,a=r.data.elem,f=u.index,l;e.browser.opera&&(o==="keypress"&&(o="keydown"),o==="input"&&(o+=".opera"));switch(r.keyCode){case 8:o+=".backspace";break;case 37:o+=".left";break;case 39:o+=".right";break;case 46:o+=".delete"}switch(o){case"keydown.right":l=t(a[0]),l.start===this.value.length&&f!==n.length-1&&(n.eq(f+1).focus(),t(n[f+1],0,0),r.preventDefault());break;case"keydown.backspace":case"keydown.left":l=t(a[0]);if(l.start===l.end&&l.start===0&&f!==0){var c=n.eq(f-1),h=c.val().length;c.focus(),t(c[0],h,h),o==="keydown.left"&&r.preventDefault()}break;case"keyup":case"keydown":if(r.keyCode<48)break;if(o==="keyup"&&u.ignoreNextKeyup){u.ignoreNextKeyup=!1;break}if(r.metaKey){u.ignoreNextKeyup=!0;break}l=t(a[0]),l.start===l.end&&l.start===this.value.length&&f!==n.length-1&&this.value.length===u.maxlength&&(n.eq(f+1).focus(),t(n[f+1],0,0));break;case"paste":a.attr("maxlength",i);break;case"propertychange":case"input":a.attr("maxlength")!==u.maxlength&&setTimeout(function(){s(a,u),a.attr("maxlength",u.maxlength)},0);break;case"input.opera":s(a,u)}}if(/iPad|iPhone/.test(navigator.platform))return this;var n=this,r=[],i=0;return n.each(function(e){var t=n.eq(e),s=+t.attr("maxlength");i+=s,r.push(s),t.on("keydown keypress keyup input paste propertychange",{elem:t,index:e,maxlength:s},o)}),e.browser.opera&&n.attr("maxlength",i),this}})(jQuery);